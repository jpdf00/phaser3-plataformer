import Phaser from"phaser";export default class GameScene extends Phaser.Scene{constructor(){super("Game")}init(){this.score=0,this.scoreText="",this.playerJumps=0}addPlatform(t,e){let s;this.platformPool.getLength()?(s=this.platformPool.getFirst(),s.x=e,s.active=!0,s.visible=!0,this.platformPool.remove(s)):(s=this.physics.add.sprite(e,Phaser.Math.Between(464,650),"platform"),s.setImmovable(!0),s.setVelocityX(-350),s.setFrictionX(0),this.platformGroup.add(s)),s.displayWidth=t,this.nextPlatformDistance=Phaser.Math.Between(50,350)}jump(){(this.player.body.touching.down||this.playerJumps>0&&this.playerJumps<2)&&(this.player.body.touching.down&&(this.playerJumps=0),this.player.setVelocityY(-500),this.playerJumps+=1,this.player.anims.stop())}create(){this.add.image(400,300,"sky").setScale(3),this.platformGroup=this.add.group({removeCallback(t){t.scene.platformPool.add(t)}}),this.platformPool=this.add.group({removeCallback(t){t.scene.platformGroup.add(t)}}),this.addPlatform(600,500),this.scoreText=this.add.text(24,24,"Score: 0 seconds",{fontSize:"32px",fill:"#000"}),this.player=this.physics.add.sprite(300,250,"player").setScale(1.5),this.player.setGravityY(900),this.anims.create({key:"run",frames:this.anims.generateFrameNumbers("player",{start:0,end:2}),frameRate:6,repeat:-1}),this.physics.add.collider(this.player,this.platformGroup,(()=>{this.player.anims.isPlaying||this.player.anims.play("run")}),null),this.input.on("pointerdown",this.jump,this),this.frame=this.add.image(400,300,"frame"),this.frame.depth=999}update(){(this.player.y>800||this.player.x<0)&&this.scene.start("GameOver",{score:Phaser.Math.RoundTo(this.score,0)}),this.score+=1/60,this.scoreText.setText(`Score: ${Phaser.Math.RoundTo(this.score,0)} seconds`);let t=800;if(this.platformGroup.getChildren().forEach((e=>{const s=800-e.x-e.displayWidth/2;t=Math.min(t,s),e.x<-e.displayWidth/2&&(this.platformGroup.killAndHide(e),this.platformGroup.remove(e))})),t>this.nextPlatformDistance){const t=Phaser.Math.Between(100,250);this.addPlatform(t,800+t/2)}}}